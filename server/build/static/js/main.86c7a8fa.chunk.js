(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{141:function(e,t,r){},197:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),s=r(10),c=r.n(s),o=(r(141),r(237)),i=r(58),u=r(13),l=r(75),d=r(115),b=r.n(d),f=r(116),p=r(55),j="GET_USER",h="SET_FETCHING_STATUS",m=function(e){return{type:j,user:e}},x=function(e){return{type:h,isFetching:e}},g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isFetching:!0},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case j:return t.user;case h:return Object(p.a)(Object(p.a)({},e),{},{isFetching:t.isFetching});default:return e}},O=r(126),v=r(145)(),w=function(e,t){var r=t.message,n=t.sender,a=v(e);if(null!==n){var s={id:r.conversationId,otherUser:n,messages:[r]};return s.latestMessageText=r.text,[s].concat(Object(O.a)(a))}return a.map((function(e){if(e.id===r.conversationId){var t=v(e);return t.messages.push(r),t.latestMessageText=r.text,t}return e}))},y=function(e,t){return e.map((function(e){if(e.otherUser.id===t){var r=v(e);return r.otherUser.online=!0,r}return e}))},S=function(e,t){return e.map((function(e){if(e.otherUser.id===t){var r=v(e);return r.otherUser.online=!1,r}return e}))},C=function(e,t){var r={};e.forEach((function(e){r[e.otherUser.id]=!0}));var n=v(e);return t.forEach((function(e){if(!r[e.id]){var t={otherUser:e,messages:[]};n.push(t)}})),n},E=function(e,t,r){return e.map((function(e){if(e.otherUser.id===t){var n=v(e);return n.id=r.conversationId,n.messages.push(r),n.latestMessageText=r.text,n}return e}))},N=function(e,t){return e.map((function(e){if(e.id===t){var r=e.messages.map((function(t){if(t.senderId===e.otherUser.id){var r=v(t);return r.read=!0,r}return t}));return Object(p.a)(Object(p.a)({},e),{},{messages:r})}return e}))},k="GET_CONVERSATIONS",U="SET_MESSAGE",F="ADD_ONLINE_USER",I="REMOVE_OFFLINE_USER",A="SET_SEARCHED_USERS",D="CLEAR_SEARCHED_USERS",T="ADD_CONVERSATION",B="SET_READ_MESSAGES",R=function(e,t){return{type:U,payload:{message:e,sender:t||null}}},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:return t.conversations;case U:return w(e,t.payload);case F:return y(e,t.id);case I:return S(e,t.id);case A:return C(e,t.users);case D:return e.filter((function(e){return e.id}));case T:return E(e,t.payload.recipientId,t.payload.newMessage);case B:return N(e,t.conversationId);default:return e}},L="SET_ACTIVE_CHAT",W=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;switch(t.type){case L:return t.username;default:return e}},_="CLEAR_ON_LOGOUT",P=Object(l.b)({user:g,conversations:z,activeConversation:W}),M=Object(l.c)((function(e,t){return t.type===_&&(e=void 0),P(e,t)}),Object(l.a)(f.a,b.a)),G=r(238),q=r(125),H=Object(q.a)({typography:{fontFamily:"Open Sans, sans-serif",fontSize:14,button:{textTransform:"none",letterSpacing:0,fontWeight:"bold"},header1:{fontSize:20}},overrides:{MuiInput:{input:{fontWeight:"bold"}}},palette:{primary:{main:"#3A8DFF"},secondary:{main:"#B0B0B0"}}}),V=r(19),J=r(15),$=r(9),K=r.n($),Q=r(21),X=r(40),Y=r.n(X),Z=r(120),ee=r.n(Z)()(window.location.origin),te=!1;ee.on("connect",(function(){console.log("connected to server"),ee.emit("authentication",{username:M.getState().user.username}),ee.on("authenticated",(function(){te=!0,ee.emit("go-online",M.getState().user.id)})),ee.on("add-online-user",(function(e){te?M.dispatch(function(e){return{type:F,id:e}}(e)):console.log("Invalid user")})),ee.on("remove-offline-user",(function(e){te?M.dispatch(function(e){return{type:I,id:e}}(e)):console.log("User not found")})),ee.on("new-message",(function(e){te?M.dispatch(R(e.message,e.sender,e.recipientId)):console.log("Invalid user")}))}));var re=ee,ne=function(){var e=Object(Q.a)(K.a.mark((function e(t){var r,n;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Y.a.post("/api/messages",t);case 3:return r=e.sent,n=r.data,e.abrupt("return",n);case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}(),ae=function(e,t){re.emit("new-message",{message:e.message,recipientId:t.recipientId,sender:e.sender})},se=function(e){return function(){var t=Object(Q.a)(K.a.mark((function t(r){var n;return K.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ne(e);case 3:n=t.sent,e.conversationId?(r(R(n.message)),ae(n,e)):(r((a=e.recipientId,s=n.message,{type:T,payload:{recipientId:a,newMessage:s}})),ae(n,e)),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),console.error(t.t0);case 10:case"end":return t.stop()}var a,s}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},ce=function(e){return function(){var t=Object(Q.a)(K.a.mark((function t(r){var n,a;return K.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Y.a.get("/api/users/".concat(e));case 3:n=t.sent,a=n.data,r({type:A,users:a}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},oe=r(233),ie=r(240),ue=r(200),le=r(241),de=r(228),be=r(239),fe=r(2),pe=function(e){var t=e.classes;return Object(fe.jsxs)(ie.a,{children:[Object(fe.jsx)(ie.a,{children:Object(fe.jsx)(de.a,{className:t.formField,margin:"normal",required:!0,children:Object(fe.jsx)(be.a,{"aria-label":"Username",label:"Username",name:"username",type:"text"})})}),Object(fe.jsx)(de.a,{className:t.formField,margin:"normal",required:!0,children:Object(fe.jsx)(be.a,{label:"Password","aria-label":"password",type:"password",name:"password"})}),Object(fe.jsx)(ie.a,{className:t.submitBtnContainer,children:Object(fe.jsx)(le.a,{className:t.submitBtn,style:{fontSize:"1.3rem"},type:"submit",variant:"contained",size:"large",children:"Login"})})]})},je=r(232),he=function(e){var t=e.classes,r=e.formErrorMessage;return Object(fe.jsxs)(ie.a,{children:[Object(fe.jsx)(ie.a,{children:Object(fe.jsx)(de.a,{className:t.formField,children:Object(fe.jsx)(be.a,{"aria-label":"username",label:"Username",name:"username",type:"text",required:!0})})}),Object(fe.jsx)(ie.a,{children:Object(fe.jsx)(de.a,{className:t.formField,children:Object(fe.jsx)(be.a,{label:"E-mail address","aria-label":"e-mail address",type:"email",name:"email",required:!0})})}),Object(fe.jsx)(ie.a,{children:Object(fe.jsxs)(de.a,{className:t.formField,error:!!r.confirmPassword,children:[Object(fe.jsx)(be.a,{"aria-label":"password",label:"Password",type:"password",inputProps:{minLength:6},name:"password",required:!0}),Object(fe.jsx)(je.a,{children:r.confirmPassword})]})}),Object(fe.jsx)(ie.a,{children:Object(fe.jsxs)(de.a,{className:t.formField,error:!!r.confirmPassword,children:[Object(fe.jsx)(be.a,{label:"Confirm Password","aria-label":"confirm password",type:"password",inputProps:{minLength:6},name:"confirmPassword",required:!0}),Object(fe.jsx)(je.a,{children:r.confirmPassword})]})}),Object(fe.jsx)(ie.a,{className:t.submitBtnContainer,children:Object(fe.jsx)(le.a,{className:t.submitBtn,style:{fontSize:"1.3rem"},type:"submit",variant:"contained",size:"large",children:"Create"})})]})},me=Object(oe.a)((function(){return{root:{display:"flex","@media (max-width: 800px)":{flexDirection:"column"}},bg:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",backgroundImage:"linear-gradient(to top, rgba(134, 185, 255, 85%), rgba(58, 141, 255, 85%)), url(./assets/images/bg-img-compressed.png)",backgroundSize:"cover",height:"100vh",width:"40%",color:"white",textAlign:"center","@media (max-width: 800px)":{width:"100vw",height:"40%"}},converse:{margin:"50px 100px 100px 100px"},speechBubble:{height:"100px","@media (max-width: 800px)":{marginTop:"50px"}},loginOrRegister:{display:"flex",alignItems:"center",position:"absolute",right:"0%",margin:"30px","@media (max-width: 800px)":{bottom:"0%"}},prompt:{color:"#BFBEBE"},promptBtn:{padding:"20px 50px",borderRadius:"5px",marginLeft:"30px",boxShadow:"0 0 10px #CFCECE",color:"#3A8DFF"},formContainer:{display:"flex",justifyContent:"center",alignItems:"center",flexGrow:1,"@media (max-width: 800px)":{marginTop:"40px"}},form:{width:"60%"},formField:{width:"100%",marginTop:"50px"},submitBtn:{backgroundColor:"#3A8DFF",color:"white",padding:"20px 75px"},submitBtnContainer:{display:"flex",justifyContent:"center",marginTop:"75px"}}})),xe=function(){var e=me(),t=Object(u.d)((function(e){return e})).user,r=Object(u.c)(),a=Object(n.useState)("Signup"),s=Object(V.a)(a,2),c=s[0],o=s[1],i=Object(n.useState)({}),l=Object(V.a)(i,2),d=l[0],b=l[1];return t.id?Object(fe.jsx)(J.a,{to:"/home"}):Object(fe.jsxs)(ie.a,{className:e.root,container:!0,justify:"center",children:[Object(fe.jsxs)("div",{className:e.bg,children:[Object(fe.jsx)("img",{className:e.speechBubble,src:"./assets/icons/bubble.svg",alt:""}),Object(fe.jsx)(ue.a,{className:e.converse,style:{fontSize:"2.5rem"},children:"Converse with anyone in any language"})]}),Object(fe.jsxs)(ie.a,{className:e.loginOrRegister,children:[Object(fe.jsx)(ue.a,{style:{fontSize:"1.3rem"},className:e.prompt,children:"Signup"===c?"Already have an account?":"Don't have an account?"}),Object(fe.jsx)(le.a,{style:{fontSize:"1.3rem"},className:e.promptBtn,onClick:function(){"Signup"===c&&o("Login"),"Login"===c&&o("Signup")},children:"Signup"===c?"Login":"Create Account"})]}),Object(fe.jsx)(ie.a,{className:e.formContainer,children:Object(fe.jsxs)("form",{className:e.form,onSubmit:"Signup"===c?function(e){e.preventDefault();var t,n=e.target.username.value,a=e.target.email.value,s=e.target.password.value;s===e.target.confirmPassword.value?r((t={username:n,email:a,password:s},function(){var e=Object(Q.a)(K.a.mark((function e(r){var n,a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Y.a.post("/auth/register",t);case 3:n=e.sent,a=n.data,r(m(a)),window.location.reload(),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0),r(m({error:e.t0.response.data.error||"Server Error"}));case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}())):b({confirmPassword:"Passwords must match"})}:function(e){e.preventDefault();var t,n=e.target.username.value,a=e.target.password.value;r((t={username:n,password:a},function(){var e=Object(Q.a)(K.a.mark((function e(r){var n,a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Y.a.post("/auth/login",t);case 3:n=e.sent,a=n.data,r(m(a)),window.location.reload(),e.next=13;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0),r(m({error:e.t0.response.data.error||"Server Error"}));case 13:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()))},children:[Object(fe.jsx)(ue.a,{style:{fontSize:"2.5rem",fontWeight:"700",whiteSpace:"nowrap"},children:"Signup"===c?"Create an account.":"Welcome back!"}),"Signup"===c?Object(fe.jsx)(he,{formErrorMessage:d,classes:e}):Object(fe.jsx)(pe,{classes:e})]})})]})},ge=r(236),Oe=Object(oe.a)((function(){return{root:{display:"flex",flexDirection:"column",alignItems:"flex-end"},date:{fontSize:11,color:"#BECCE2",fontWeight:"bold",marginBottom:5},text:{fontSize:14,color:"#91A3C0",letterSpacing:-.2,padding:8,fontWeight:"bold"},bubble:{background:"#F4F6FA",borderRadius:"10px 10px 0 10px"}}})),ve=function(e){var t=e.time,r=e.text,n=Oe();return Object(fe.jsxs)(ie.a,{className:n.root,children:[Object(fe.jsx)(ue.a,{className:n.date,children:t}),Object(fe.jsx)(ie.a,{className:n.bubble,children:Object(fe.jsx)(ue.a,{className:n.text,children:r})})]})},we=r(244),ye=Object(oe.a)((function(){return{root:{display:"flex"},avatar:{height:30,width:30,marginRight:11,marginTop:6},usernameDate:{fontSize:11,color:"#BECCE2",fontWeight:"bold",marginBottom:5},bubble:{backgroundImage:"linear-gradient(225deg, #6CC1FF 0%, #3A8DFF 100%)",borderRadius:"0 10px 10px 10px"},text:{fontSize:14,fontWeight:"bold",color:"#FFFFFF",letterSpacing:-.2,padding:8}}})),Se=function(e){var t=e.text,r=e.time,n=e.otherUser,a=ye();return Object(fe.jsxs)(ie.a,{className:a.root,children:[Object(fe.jsx)(we.a,{alt:n.username,src:n.photoUrl,className:a.avatar}),Object(fe.jsxs)(ie.a,{children:[Object(fe.jsxs)(ue.a,{className:a.usernameDate,children:[n.username," ",r]}),Object(fe.jsx)(ie.a,{className:a.bubble,children:Object(fe.jsx)(ue.a,{className:a.text,children:t})})]})]})},Ce=Object(oe.a)((function(){return{root:{display:"flex",flexGrow:8,flexDirection:"column"},chatContainer:{marginLeft:41,marginRight:41,display:"flex",flexDirection:"column",flexGrow:1,justifyContent:"space-between"}}})),Ee=function(){var e=Ce(),t=Object(u.d)((function(e){return[e.user,e.conversations,e.activeConversation]})),r=Object(V.a)(t,3),n=r[0],a=r[1],s=r[2],c=a&&a.find((function(e){return e.otherUser.username===s}))||{};return Object(fe.jsx)(ie.a,{className:e.root,children:c.otherUser&&Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)(De,{username:c.otherUser.username,online:c.otherUser.online||!1}),Object(fe.jsxs)(ie.a,{className:e.chatContainer,children:[Object(fe.jsx)(ze,{messages:c.messages,otherUser:c.otherUser,userId:n.id}),Object(fe.jsx)(Ue,{otherUser:c.otherUser,conversationId:c.id,user:n})]})]})})},Ne=r(230),ke=Object(oe.a)((function(){return{root:{justifySelf:"flex-end",marginTop:15},input:{height:70,backgroundColor:"#F4F6FA",borderRadius:8,marginBottom:20}}})),Ue=function(e){var t=e.otherUser,r=e.conversationId,a=e.user,s=Object(n.useState)(""),c=Object(V.a)(s,2),o=c[0],i=c[1],l=ke(),d=Object(u.c)(),b=function(){var e=Object(Q.a)(K.a.mark((function e(n){var s;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),s={text:n.target.text.value,recipientId:t.id,conversationId:r,sender:r?null:a,read:!1},e.next=4,d(se(s));case 4:i("");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(fe.jsx)("form",{className:l.root,onSubmit:b,children:Object(fe.jsx)(de.a,{fullWidth:!0,hiddenLabel:!0,children:Object(fe.jsx)(Ne.a,{classes:{root:l.input},disableUnderline:!0,placeholder:"Type something...",value:o,name:"text",onChange:function(e){i(e.target.value)}})})})},Fe=r(74),Ie=r.n(Fe),Ae=Object(oe.a)((function(e){return{root:{display:"flex",alignItems:"center",justifyContent:"space-between",height:89,marginBottom:34,boxShadow:"0 2px 20px 0 rgba(88,133,196,0.10)"},content:{display:"flex",alignItems:"center",marginLeft:24},username:{fontSize:20,letterSpacing:-.29,fontWeight:"bold",marginRight:14},statusText:{fontSize:12,color:"#BFC9DB",letterSpacing:-.17},statusDot:{height:8,width:8,borderRadius:"50%",marginRight:5,backgroundColor:"#D0DAE9"},online:{background:"#1CED84"},ellipsis:{color:"#95A7C4",marginRight:24,opacity:.5}}})),De=function(e){var t=e.username,r=e.online,n=Ae();return Object(fe.jsxs)(ie.a,{className:n.root,children:[Object(fe.jsxs)(ie.a,{className:n.content,children:[Object(fe.jsx)(ue.a,{className:n.username,children:t}),Object(fe.jsx)(ie.a,{className:"".concat(n.statusDot," ").concat(n[r&&"online"])}),Object(fe.jsx)(ue.a,{className:n.statusText,children:r?"Online":"Offline"})]}),Object(fe.jsx)(Ie.a,{classes:{root:n.ellipsis}})]})},Te=r(122),Be=r.n(Te),Re=Object(oe.a)((function(){return{msgContainer:{display:"flex",justifyContent:"flex-end"},readAvatar:{height:"15px",width:"15px",alignSelf:"flex-end"}}})),ze=function(e){var t=e.messages,r=e.otherUser,a=e.userId,s=Re(),c=Object(n.useState)(null),o=Object(V.a)(c,2),i=o[0],u=o[1],l=Object(n.useCallback)((function(){for(var e=0;e<t.length;e++)!0===t[e].read&&t[e].senderId===a&&u(t[e])}),[t,a]);return Object(n.useEffect)((function(){l()}),[t,l]),Object(fe.jsx)(ie.a,{children:t.map((function(e){var t=Be()(e.createdAt).format("h:mm");return e.senderId===a?Object(fe.jsxs)("div",{className:s.msgContainer,children:[Object(fe.jsx)(ve,{text:e.text,time:t},e.id),(null===i||void 0===i?void 0:i.id)===e.id&&Object(fe.jsx)(we.a,{alt:r.username,src:r.photoUrl,className:s.readAvatar})]}):Object(fe.jsx)(Se,{text:e.text,time:t,otherUser:r},e.id)}))})},Le=Object(oe.a)((function(e){return{root:{display:"flex",justifyContent:"space-between",marginLeft:20,flexGrow:1},username:{fontWeight:"bold",letterSpacing:-.2},previewText:{fontSize:12,color:"#9CADC8",letterSpacing:-.17},notification:{height:20,width:20,backgroundColor:"#3F92FF",marginRight:10,color:"white",fontSize:10,letterSpacing:-.5,fontWeight:"bold",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:10},unread:{backgroundColor:"dodgerblue",minWidth:"30px",height:"min-content",marginRight:"20px",padding:"5px",borderRadius:"100%",textAlign:"center",fontWeight:"900",color:"white"}}})),We=function(e){var t=Le(),r=e.conversation,a=r.latestMessageText,s=r.otherUser,c=Object(n.useState)(null),o=Object(V.a)(c,2),i=o[0],u=o[1],l=Object(n.useCallback)((function(){var e=0;return r.messages.forEach((function(t){!1===t.read&&t.senderId===s.id&&e++})),u(0===e?null:e)}),[r.messages,s]);return Object(n.useEffect)((function(){l()}),[l]),Object(fe.jsxs)(ie.a,{className:t.root,children:[Object(fe.jsxs)(ie.a,{children:[Object(fe.jsx)(ue.a,{className:t.username,children:s.username}),Object(fe.jsx)(ue.a,{className:t.previewText,children:a})]}),i&&Object(fe.jsx)(ie.a,{className:t.unread,children:i})]})},_e=Object(oe.a)((function(){return{root:{height:44,marginTop:23,marginLeft:6,display:"flex",alignItems:"center"},subContainer:{display:"flex",justifyContent:"space-between",alignItems:"center",flexGrow:1},username:{letterSpacing:-.23,fontSize:16,fontWeight:"bold",marginLeft:17},ellipsis:{color:"#95A7C4",marginRight:24,opacity:.5}}})),Pe=function(){var e=_e(),t=Object(u.d)((function(e){return e.user}))||{};return Object(fe.jsxs)(ie.a,{className:e.root,children:[Object(fe.jsx)(et,{photoUrl:t.photoUrl,online:!0}),Object(fe.jsxs)(ie.a,{className:e.subContainer,children:[Object(fe.jsx)(ue.a,{className:e.username,children:t.username}),Object(fe.jsx)(Ie.a,{classes:{root:e.ellipsis}})]})]})},Me=r(234),Ge=r(123),qe=r.n(Ge),He=Object(oe.a)((function(){return{filledInput:{height:50,background:"#E9EEF9",borderRadius:5,fontSize:13,fontWeight:"bold",color:"#99A9C4",letterSpacing:0,display:"flex",justifyContent:"center",marginBottom:20},input:{"&::placeholder":{color:"#ADC0DE",opacity:1}}}})),Ve=function(e){var t=e.handleChange,r=He();return Object(fe.jsx)("form",{onSubmit:function(e){e.preventDefault()},children:Object(fe.jsx)(de.a,{fullWidth:!0,hiddenLabel:!0,children:Object(fe.jsx)(Ne.a,{name:"search",onChange:t,classes:{root:r.filledInput,input:r.input},disableUnderline:!0,placeholder:"Search",startAdornment:Object(fe.jsx)(Me.a,{position:"start",children:Object(fe.jsx)(qe.a,{})})})})})},Je=Object(oe.a)((function(){return{root:{paddingLeft:21,paddingRight:21,flexGrow:1},title:{fontSize:20,letterSpacing:-.29,fontWeight:"bold",marginTop:32,marginBottom:15}}})),$e=function(e){var t=e.handleChange,r=e.searchTerm,n=Je(),a=Object(u.d)((function(e){return e.conversations}))||[];return Object(fe.jsxs)(ie.a,{className:n.root,children:[Object(fe.jsx)(Pe,{}),Object(fe.jsx)(ue.a,{className:n.title,children:"Chats"}),Object(fe.jsx)(Ve,{handleChange:t}),a.filter((function(e){return e.otherUser.username.includes(r)})).map((function(e){return Object(fe.jsx)(Xe,{conversation:e},e.otherUser.username)}))]})},Ke=function(){var e=Object(u.c)(),t=Object(n.useState)(""),r=Object(V.a)(t,2),a=r[0],s=r[1],c=function(){var t=Object(Q.a)(K.a.mark((function t(r){return K.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==r.target.value){t.next=5;break}return t.next=3,e({type:D});case 3:return s(""),t.abrupt("return");case 5:if(!a.includes(r.target.value)){t.next=8;break}return s(r.target.value),t.abrupt("return");case 8:return t.next=10,e(ce(r.target.value));case 10:s(r.target.value);case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(fe.jsx)($e,{handleChange:c,searchTerm:a})},Qe=Object(oe.a)((function(){return{root:{borderRadius:8,height:80,boxShadow:"0 2px 10px 0 rgba(88,133,196,0.05)",marginBottom:10,display:"flex",alignItems:"center","&:hover":{cursor:"grab"}}}})),Xe=function(e){var t=e.conversation,r=Qe(),n=Object(u.c)(),a=function(e){var t,r,a;n((t=e.otherUser.username,{type:L,username:t})),n((r=e.id,{type:B,conversationId:r})),n((a={conversation:e.id,otherUserId:e.otherUser.id},function(){var e=Object(Q.a)(K.a.mark((function e(t){var r;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Y.a.put("/api/conversationsPost",a);case 3:return r=e.sent,e.abrupt("return",r);case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}()))},s=t.otherUser;return Object(fe.jsxs)(ie.a,{onClick:function(){return a(t)},className:r.root,children:[Object(fe.jsx)(et,{photoUrl:s.photoUrl,username:s.username,online:s.online,sidebar:!0}),Object(fe.jsx)(We,{conversation:t})]})},Ye=r(235),Ze=Object(oe.a)((function(){return{profilePic:{height:44,width:44},badge:{height:13,width:13,borderRadius:"50%",border:"2px solid white",backgroundColor:"#D0DAE9"},online:{backgroundColor:"#1CED84"},sidebar:{marginLeft:17}}})),et=function(e){var t=e.sidebar,r=e.username,n=e.photoUrl,a=e.online,s=Ze();return Object(fe.jsx)(ie.a,{className:t?s.sidebar:"",children:Object(fe.jsx)(Ye.a,{classes:{badge:"".concat(s.badge," ").concat(a&&s.online)},variant:"dot",anchorOrigin:{horizontal:"right",vertical:"bottom"},overlap:"circle",children:Object(fe.jsx)(we.a,{alt:r,src:n,className:s.profilePic})})})},tt=Object(oe.a)((function(){return{root:{height:"97vh"}}})),rt=function(){var e=Object(n.useState)(!1),t=Object(V.a)(e,2),r=(t[0],t[1]),a=tt(),s=Object(u.d)((function(e){return[e.user,e.conversations]})),c=Object(V.a)(s,2),o=c[0],i=(c[1],Object(u.c)());Object(n.useEffect)((function(){r(!0)}),[o.id]),Object(n.useEffect)((function(){i(function(){var e=Object(Q.a)(K.a.mark((function e(t){var r,n;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Y.a.get("/api/conversations");case 3:r=e.sent,n=r.data,t({type:k,conversations:n}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())}),[i]);var l=function(){var e=Object(Q.a)(K.a.mark((function e(){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i((o.id,function(){var e=Object(Q.a)(K.a.mark((function e(t){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Y.a.delete("/auth/logout");case 3:t(m({})),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}()));case 2:return e.next=4,i({type:_});case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return o.id?Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)(le.a,{className:a.logout,onClick:l,children:"Logout"}),Object(fe.jsxs)(ge.a,{container:!0,component:"main",className:a.root,children:[Object(fe.jsx)(Ke,{}),Object(fe.jsx)(Ee,{})]})]}):Object(fe.jsx)(J.a,{to:"/auth"})},nt=r(243),at=r(124),st=r.n(at),ct=Object(oe.a)((function(e){return{snackbar:{backgroundColor:"red",fontWeight:"bold"},icon:{color:"white"}}})),ot=function(e){var t=ct();return Object(fe.jsx)(nt.a,{open:e.snackBarOpen,onClose:function(){return e.setSnackBarOpen(!1)},message:e.errorMessage||"Sorry, an error occured. Please try again",action:Object(fe.jsx)(a.a.Fragment,{children:Object(fe.jsx)(le.a,{className:t.icon,size:"small",onClick:function(){return e.setSnackBarOpen(!1)},children:Object(fe.jsx)(st.a,{color:"secondary"})})}),ContentProps:{classes:{root:t.snackbar}}})},it=Object(J.g)(Object(u.b)((function(e){return{user:e.user}}),(function(e){return{fetchUser:function(){e(function(){var e=Object(Q.a)(K.a.mark((function e(t){var r,n;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t(x(!0)),e.prev=1,e.next=4,Y.a.get("/auth/user");case 4:r=e.sent,n=r.data,t(m(n)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.error(e.t0);case 12:return e.prev=12,t(x(!1)),e.finish(12);case 15:case"end":return e.stop()}}),e,null,[[1,9,12,15]])})));return function(t){return e.apply(this,arguments)}}())}}}))((function(e){var t=e.user,r=e.fetchUser,a=Object(n.useState)(""),s=Object(V.a)(a,2),c=s[0],o=s[1],i=Object(n.useState)(!1),u=Object(V.a)(i,2),l=u[0],d=u[1];return Object(n.useEffect)((function(){r()}),[r]),Object(n.useEffect)((function(){t.error&&("string"===typeof t.error?o(t.error):o("Internal Server Error. Please try again"),d(!0))}),[t.error]),e.user.isFetchingUser?Object(fe.jsx)("div",{children:"Loading..."}):Object(fe.jsxs)(fe.Fragment,{children:[l&&Object(fe.jsx)(ot,{setSnackBarOpen:d,errorMessage:c,snackBarOpen:l}),Object(fe.jsxs)(J.d,{children:[Object(fe.jsx)(J.b,{path:"/auth",component:xe}),Object(fe.jsx)(J.b,{exact:!0,path:"/",render:function(e){var t;return(null===(t=e.user)||void 0===t?void 0:t.id)?Object(fe.jsx)(rt,{}):Object(fe.jsx)(xe,{})}}),Object(fe.jsx)(J.b,{path:"/home",component:rt})]})]})})));var ut=function(){return Object(fe.jsx)(u.a,{store:M,children:Object(fe.jsx)(o.a,{theme:H,children:Object(fe.jsxs)(i.a,{children:[Object(fe.jsx)(G.a,{}),Object(fe.jsx)(it,{})]})})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(fe.jsx)(ut,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[197,1,2]]]);
//# sourceMappingURL=main.86c7a8fa.chunk.js.map